\doxysection{vl53l1\+\_\+platform.\+h}
\hypertarget{vl53l1__platform_8h_source}{}\label{vl53l1__platform_8h_source}\index{vl53l1\_platform.h@{vl53l1\_platform.h}}
\mbox{\hyperlink{vl53l1__platform_8h}{Aller Ã  la documentation de ce fichier.}}
\begin{DoxyCode}{0}
\DoxyCodeLine{00001\ \textcolor{comment}{/*}}
\DoxyCodeLine{00002\ \textcolor{comment}{\ ******************************************************************************}}
\DoxyCodeLine{00003\ \textcolor{comment}{\ *\ @attention}}
\DoxyCodeLine{00004\ \textcolor{comment}{\ *\ Author:\ CHAIR}}
\DoxyCodeLine{00005\ \textcolor{comment}{\ *\ Copyright\ (c)\ 2024\ STMicroelectronics.}}
\DoxyCodeLine{00006\ \textcolor{comment}{\ *\ All\ rights\ reserved.}}
\DoxyCodeLine{00007\ \textcolor{comment}{\ *}}
\DoxyCodeLine{00008\ \textcolor{comment}{\ *\ This\ software\ is\ licensed\ under\ terms\ that\ can\ be\ found\ in\ the\ LICENSE\ file}}
\DoxyCodeLine{00009\ \textcolor{comment}{\ *\ in\ the\ root\ directory\ of\ this\ software\ component.}}
\DoxyCodeLine{00010\ \textcolor{comment}{\ *\ If\ no\ LICENSE\ file\ comes\ with\ this\ software,\ it\ is\ provided\ AS-\/IS.}}
\DoxyCodeLine{00011\ \textcolor{comment}{\ *}}
\DoxyCodeLine{00012\ \textcolor{comment}{\ ******************************************************************************}}
\DoxyCodeLine{00013\ \textcolor{comment}{\ */}}
\DoxyCodeLine{00014\ \ }
\DoxyCodeLine{00015\ \textcolor{preprocessor}{\#include\ "{}\mbox{\hyperlink{main_8h}{main.h}}"{}}}
\DoxyCodeLine{00016\ \textcolor{preprocessor}{\#include\ "{}\mbox{\hyperlink{z__vl53l1x__test_8h}{z\_vl53l1x\_test.h}}"{}}}
\DoxyCodeLine{00017\ }
\DoxyCodeLine{00018\ \textcolor{preprocessor}{\#ifndef\ \_VL53L1\_PLATFORM\_H\_}}
\DoxyCodeLine{00019\ \textcolor{preprocessor}{\#define\ \_VL53L1\_PLATFORM\_H\_}}
\DoxyCodeLine{00020\ }
\DoxyCodeLine{00021\ \textcolor{comment}{/*|||||||||||\ USER/PROJECT\ PARAMETERS\ |||||||||||*/}}
\DoxyCodeLine{00022\ }
\DoxyCodeLine{00023\ \textcolor{comment}{/*****************\ \ \ \ \ STEP\ 1\ \ \ \ \ \ *****************g}}
\DoxyCodeLine{00024\ \textcolor{comment}{\ ****************\ I2C\ communication\ ****************}}
\DoxyCodeLine{00025\ \textcolor{comment}{\ *\ set\ information\ about\ the\ I2c\ connection}}
\DoxyCodeLine{00026\ \textcolor{comment}{\ ***************************************************/}}
\DoxyCodeLine{00027\ \textcolor{preprocessor}{\#define\ TOF\_PORT\ \ \ \ hi2c1\ \ \ \ \ \ \ \ \ \ \ }\textcolor{comment}{//\ that's\ the\ I2C\ port\ connected\ to\ VI53L1X}}
\DoxyCodeLine{00028\ \textcolor{preprocessor}{\#define\ TOF\_ADDR\ \ \ \ 0x52\ \ \ \ \ \ \ \ \ \ \ \ }\textcolor{comment}{//\ the\ VL53L1X\ I2C\ chip\ address}}
\DoxyCodeLine{00029\ }
\DoxyCodeLine{00030\ }
\DoxyCodeLine{00031\ \textcolor{comment}{/*****************\ \ \ \ \ STEP\ 2\ \ \ \ \ \ *****************}}
\DoxyCodeLine{00032\ \textcolor{comment}{\ **********\ VL53L1X\ ranging\ configuration\ **********}}
\DoxyCodeLine{00033\ \textcolor{comment}{\ *\ these\ parameters\ set\ the\ ranging\ configuration}}
\DoxyCodeLine{00034\ \textcolor{comment}{\ *\ on\ the\ device\ boot}}
\DoxyCodeLine{00035\ \textcolor{comment}{\ ***************************************************/}}
\DoxyCodeLine{00036\ \textcolor{preprocessor}{\#define\ VL53L1\_\_DISTANCE\_MODE\ \ \ (2)\ \ \ \ \ }\textcolor{comment}{//\ 1=short,\ 2=long}}
\DoxyCodeLine{00037\ \textcolor{preprocessor}{\#define\ VL53L1\_\_TIMING\_BUDGET\ \ \ (20)\ \ \ \ }\textcolor{comment}{//\ in\ ms,\ possible\ values:\ [15\ (only\ if\ DISTANCE\ MODE\ is\ 1),\ 20,\ 33,\ 50,\ 100,\ 200,\ 500]\ -\/\ that's\ the\ time\ for\ a\ single\ reading}}
\DoxyCodeLine{00038\ \textcolor{preprocessor}{\#define\ VL53L1\_\_TB\_IM\_DELTA\ \ \ \ \ (5)\ \ \ \ \ }\textcolor{comment}{//\ in\ ms,\ added\ to\ TB\ to\ get\ IM\ setting}}
\DoxyCodeLine{00039\ \textcolor{preprocessor}{\#define\ VL53L1\_\_INTERMEASUREMENT\ \ \ \ (VL53L1\_\_TIMING\_BUDGET\ +\ VL53L1\_\_TB\_IM\_DELTA)\ \ \ \ \ \ \ }\textcolor{comment}{//\ in\ ms,\ it\ must\ be\ >\ =\ VL53L1\_TIMING\_BUDGET\ -\/\ that's\ the\ interval\ (including\ reading\ time)\ between\ two\ readings\ in\ continuous\ mode}}
\DoxyCodeLine{00040\ }
\DoxyCodeLine{00041\ }
\DoxyCodeLine{00042\ \textcolor{comment}{/*****************\ \ \ \ \ STEP\ 3\ \ \ \ \ \ *****************}}
\DoxyCodeLine{00043\ \textcolor{comment}{\ *********\ VL53L1X\ active\ window\ parameters\ ********}}
\DoxyCodeLine{00044\ \textcolor{comment}{\ *\ these\ parameters\ are\ loaded\ on\ the\ device\ boot}}
\DoxyCodeLine{00045\ \textcolor{comment}{\ *\ Detect\ them\ using\ the\ STM\ calibration\ functions}}
\DoxyCodeLine{00046\ \textcolor{comment}{\ *\ available\ in\ the\ VL53L1X\ package}}
\DoxyCodeLine{00047\ \textcolor{comment}{\ ***************************************************/}}
\DoxyCodeLine{00048\ \textcolor{preprocessor}{\#define\ VL53L1\_\_WINDOW\_MODE\ \ \ \ \ (1)\ \ \ \ \ }\textcolor{comment}{//\ 0=below,\ 1=beyond,\ 2=out\ of\ window,\ 3=inside\ window}}
\DoxyCodeLine{00049\ \textcolor{preprocessor}{\#define\ VL53L1\_\_LOWER\_THRESHOLD\ (5000)\ \ \ \ \ \ }\textcolor{comment}{//\ (mm)\ lower\ window\ limit.\ For\ WINDOW\_MODE\ =\ 0,\ 2,\ 3}}
\DoxyCodeLine{00050\ \textcolor{preprocessor}{\#define\ VL53L1\_\_UPPER\_THRESHOLD\ (5000)\ \ \ \ \ \ }\textcolor{comment}{//\ (mm)\ upper\ window\ limit.\ For\ WINDOW\_MODE\ =\ 1,\ 2,\ 3}}
\DoxyCodeLine{00051\ }
\DoxyCodeLine{00052\ }
\DoxyCodeLine{00053\ \textcolor{comment}{/*****************\ \ \ \ \ STEP\ 4\ \ \ \ \ \ *****************}}
\DoxyCodeLine{00054\ \textcolor{comment}{\ **********\ VL53L1X\ calibration\ parameters\ *********}}
\DoxyCodeLine{00055\ \textcolor{comment}{\ *\ these\ parameters\ are\ loaded\ on\ the\ device\ boot}}
\DoxyCodeLine{00056\ \textcolor{comment}{\ *\ Detect\ them\ using\ the\ STM\ calibration\ functions}}
\DoxyCodeLine{00057\ \textcolor{comment}{\ *\ available\ in\ the\ VL53L1X\ package}}
\DoxyCodeLine{00058\ \textcolor{comment}{\ ***************************************************/}}
\DoxyCodeLine{00059\ \textcolor{preprocessor}{\#define\ VL53L1\_\_CALIB\_OFFSET\ \ \ \ (-\/25)\ \ \ }\textcolor{comment}{//It\ must\ must\ be\ detected\ "{}una\ tantum"{}\ using\ VL53L1X\_CalibrateOffset()}}
\DoxyCodeLine{00060\ \textcolor{preprocessor}{\#define\ VL53L1\_\_CALIB\_XTALK\ \ \ \ \ (0)\ \ \ \ \ }\textcolor{comment}{//It\ must\ must\ be\ detected\ "{}una\ tantum"{}\ using\ VL53L1X\_CalibrateXtalk()}}
\DoxyCodeLine{00061\ }
\DoxyCodeLine{00062\ }
\DoxyCodeLine{00063\ \textcolor{comment}{/*****************\ \ \ \ \ STEP\ 5\ \ \ \ \ *****************}}
\DoxyCodeLine{00064\ \textcolor{comment}{\ *************\ range\ status\ threeshold*************}}
\DoxyCodeLine{00065\ \textcolor{comment}{\ *\ set\ the\ Range\_Status\ level\ accepted\ as\ a\ good}}
\DoxyCodeLine{00066\ \textcolor{comment}{\ *\ ranging.}}
\DoxyCodeLine{00067\ \textcolor{comment}{\ *\ (below\ or\ equal\ this\ value)}}
\DoxyCodeLine{00068\ \textcolor{comment}{\ *\ (used\ in\ the\ library\ ranging\ functions)}}
\DoxyCodeLine{00069\ \textcolor{comment}{\ *\ RANGE\ STATUS\ meaning\ (details\ on\ STM\ VL53L1X\ ULD\ user\ manual):}}
\DoxyCodeLine{00070\ \textcolor{comment}{\ *\ 0=no\ errors,}}
\DoxyCodeLine{00071\ \textcolor{comment}{\ *\ 1=\ warning:\ high\ standard\ deviation}}
\DoxyCodeLine{00072\ \textcolor{comment}{\ *\ 2=\ warning:\ low\ return\ signal\ level}}
\DoxyCodeLine{00073\ \textcolor{comment}{\ *\ 4-\/7\ errors}}
\DoxyCodeLine{00074\ \textcolor{comment}{\ *******************************************/}}
\DoxyCodeLine{00075\ \textcolor{preprocessor}{\#define\ RANGE\_STATUS\_THREEESH\ \ \ (2)\ \ \ \ \ }\textcolor{comment}{//\ acceptable\ values:\ 0,1,2,4,7}}
\DoxyCodeLine{00076\ }
\DoxyCodeLine{00077\ }
\DoxyCodeLine{00078\ \textcolor{comment}{/*||||||||\ END\ OF\ USER/PROJECT\ PARAMETERS\ ||||||||*/}}
\DoxyCodeLine{00079\ }
\DoxyCodeLine{00080\ }
\DoxyCodeLine{00081\ }
\DoxyCodeLine{00082\ \textcolor{comment}{/*||||||||||||||\ DEVICE\ PARAMETERS\ |||||||||||||||||*/}}
\DoxyCodeLine{00083\ \textcolor{comment}{/*\ you\ shouldn't\ need\ to\ change\ anything\ here\ after\ */}}
\DoxyCodeLine{00084\ }
\DoxyCodeLine{00085\ \textcolor{comment}{//\ Reference\ Registers\ for\ VL53L1X}}
\DoxyCodeLine{00086\ \textcolor{comment}{//\ allowing\ to\ validate\ I2C\ connection\ on\ boot}}
\DoxyCodeLine{00087\ \textcolor{preprocessor}{\#define\ VL53L1\_\_MODELID\_INDEX\ \ \ 0x010F}}
\DoxyCodeLine{00088\ \textcolor{preprocessor}{\#define\ VL53L1\_\_MODELID\_VALUE\ \ \ 0xEA}}
\DoxyCodeLine{00089\ \textcolor{preprocessor}{\#define\ VL53L1\_\_MODULETYPE\_INDEX\ \ \ \ 0x0110}}
\DoxyCodeLine{00090\ \textcolor{preprocessor}{\#define\ VL53L1\_\_MODULETYPE\_VALUE\ \ \ \ 0xCC}}
\DoxyCodeLine{00091\ \textcolor{preprocessor}{\#define\ VL53L1\_\_MASKREV\_INDEX\ \ \ 0x0111}}
\DoxyCodeLine{00092\ \textcolor{preprocessor}{\#define\ VL53L1\_\_MASKREV\_VALUE\ \ \ 0x10}}
\DoxyCodeLine{00093\ }
\DoxyCodeLine{00094\ }
\DoxyCodeLine{00095\ \textcolor{preprocessor}{\#define\ I2C\_COMM\_TIMEOUT\ \ \ \ \ \ \ \ 20\ \ \ \ \ \ }\textcolor{comment}{//\ ms\ timeout\ for\ the\ I2C\ communication}}
\DoxyCodeLine{00096\ }
\DoxyCodeLine{00097\ \textcolor{comment}{//\ error\ code\ returned\ by\ I/O\ interface\ functions}}
\DoxyCodeLine{00098\ \textcolor{preprocessor}{\#define\ VL53L1\_\_IO\_ERROR\ \ \ \ \ \ \ \ \ \ \ \ (\ -\/\ 13)}\textcolor{preprocessor}{}}
\DoxyCodeLine{00100\ }
\DoxyCodeLine{00101\ \textcolor{comment}{/*||||||||||||\ END\ OF\ DEVICE\ PARAMETERS\ |||||||||||||*/}}
\DoxyCodeLine{00102\ }
\DoxyCodeLine{00103\ }
\DoxyCodeLine{00104\ \textcolor{comment}{/*||||||||||||||\ PACKAGE\ PARAMETERS\ |||||||||||||||||*/}}
\DoxyCodeLine{00105\ \textcolor{comment}{/*\ declarations\ set\ by\ STM\ software\ library\ \ \ \ \ \ \ \ \ \ */}}
\DoxyCodeLine{00106\ }
\DoxyCodeLine{00107\ \textcolor{keyword}{typedef}\ \textcolor{keyword}{struct\ }\{}
\DoxyCodeLine{00108\ \ \ \ \ uint32\_t\ \mbox{\hyperlink{struct_v_l53_l1___dev__t_a44b7a3baf02bac7ad707e8f2f5eca1ca}{dummy}};}
\DoxyCodeLine{00109\ \}\ \mbox{\hyperlink{struct_v_l53_l1___dev__t}{VL53L1\_Dev\_t}};}
\DoxyCodeLine{00110\ }
\DoxyCodeLine{00111\ \textcolor{keyword}{typedef}\ \mbox{\hyperlink{struct_v_l53_l1___dev__t}{VL53L1\_Dev\_t}}\ *\mbox{\hyperlink{vl53l1__platform_8h_aff2180f6401addaf4701700ec4c1e9bb}{VL53L1\_DEV}};}
\DoxyCodeLine{00112\ }
\DoxyCodeLine{00113\ \textcolor{comment}{/*||||||||||||\ END\ OF\ PACKAGE\ PARAMETERS\ ||||||||||||*/}}
\DoxyCodeLine{00114\ }
\DoxyCodeLine{00115\ }
\DoxyCodeLine{00116\ \textcolor{comment}{//\ function\ declarations}}
\DoxyCodeLine{00117\ uint8\_t\ \ \mbox{\hyperlink{vl53l1__platform_8h_af1cfa8cfe2f246e3f9c7fc44ee53a374}{VL53L1\_\_Xshut}}(uint8\_t\ level);}
\DoxyCodeLine{00118\ uint8\_t\ \ \mbox{\hyperlink{vl53l1__platform_8h_ac5eedd9d810b6e6211499ae609e3bcb9}{VL53L1\_\_Init}}();}
\DoxyCodeLine{00119\ uint16\_t\ \mbox{\hyperlink{vl53l1__platform_8h_a9bc59cf48568109349511f543e21b0fb}{VL53L1\_\_GetDistance}}(uint8\_t\ level);}
\DoxyCodeLine{00120\ }
\DoxyCodeLine{00121\ }
\DoxyCodeLine{00122\ }
\DoxyCodeLine{00126\ int8\_t\ \mbox{\hyperlink{vl53l1__platform_8h_a837e02c5d200d439935a5e9813572e2b}{VL53L1\_WriteMulti}}(}
\DoxyCodeLine{00127\ \ \ \ \ \ \ \ \ uint16\_t\ \ \ \ \ \ \ \ \ \ \ \ dev,}
\DoxyCodeLine{00128\ \ \ \ \ \ \ \ \ uint16\_t\ \ \ \ \ \ index,}
\DoxyCodeLine{00129\ \ \ \ \ \ \ \ \ uint8\_t\ \ \ \ \ \ *pdata,}
\DoxyCodeLine{00130\ \ \ \ \ \ \ \ \ uint32\_t\ \ \ \ \ \ count);}
\DoxyCodeLine{00134\ int8\_t\ \mbox{\hyperlink{vl53l1__platform_8h_a5005e5666c0dcfe32fa0ad97f6392e31}{VL53L1\_ReadMulti}}(}
\DoxyCodeLine{00135\ \ \ \ \ \ \ \ \ uint16\_t\ \ \ \ \ \ \ \ \ \ \ \ dev,}
\DoxyCodeLine{00136\ \ \ \ \ \ \ \ \ uint16\_t\ \ \ \ \ \ index,}
\DoxyCodeLine{00137\ \ \ \ \ \ \ \ \ uint8\_t\ \ \ \ \ \ *pdata,}
\DoxyCodeLine{00138\ \ \ \ \ \ \ \ \ uint32\_t\ \ \ \ \ \ count);}
\DoxyCodeLine{00142\ int8\_t\ \mbox{\hyperlink{vl53l1__platform_8h_a3ff714533deebf1a54c3596b1681a8d3}{VL53L1\_WrByte}}(}
\DoxyCodeLine{00143\ \ \ \ \ \ \ \ \ uint16\_t\ dev,}
\DoxyCodeLine{00144\ \ \ \ \ \ \ \ \ uint16\_t\ \ \ \ \ \ index,}
\DoxyCodeLine{00145\ \ \ \ \ \ \ \ \ uint8\_t\ \ \ \ \ \ \ data);}
\DoxyCodeLine{00149\ int8\_t\ \mbox{\hyperlink{vl53l1__platform_8h_a79dafd64b8435d306696839614382ef1}{VL53L1\_WrWord}}(}
\DoxyCodeLine{00150\ \ \ \ \ \ \ \ \ uint16\_t\ dev,}
\DoxyCodeLine{00151\ \ \ \ \ \ \ \ \ uint16\_t\ \ \ \ \ \ index,}
\DoxyCodeLine{00152\ \ \ \ \ \ \ \ \ uint16\_t\ \ \ \ \ \ data);}
\DoxyCodeLine{00156\ int8\_t\ \mbox{\hyperlink{vl53l1__platform_8h_a2631e24821bb8d6ae0ef58fc060888e6}{VL53L1\_WrDWord}}(}
\DoxyCodeLine{00157\ \ \ \ \ \ \ \ \ uint16\_t\ dev,}
\DoxyCodeLine{00158\ \ \ \ \ \ \ \ \ uint16\_t\ \ \ \ \ \ index,}
\DoxyCodeLine{00159\ \ \ \ \ \ \ \ \ uint32\_t\ \ \ \ \ \ data);}
\DoxyCodeLine{00163\ int8\_t\ \mbox{\hyperlink{vl53l1__platform_8h_a37b75e3f2ac3a44abd5b600870c5888b}{VL53L1\_RdByte}}(}
\DoxyCodeLine{00164\ \ \ \ \ \ \ \ \ uint16\_t\ dev,}
\DoxyCodeLine{00165\ \ \ \ \ \ \ \ \ uint16\_t\ \ \ \ \ \ index,}
\DoxyCodeLine{00166\ \ \ \ \ \ \ \ \ uint8\_t\ \ \ \ \ \ *pdata);}
\DoxyCodeLine{00170\ int8\_t\ \mbox{\hyperlink{vl53l1__platform_8h_aec99246aff36aec732a2451479d39da3}{VL53L1\_RdWord}}(}
\DoxyCodeLine{00171\ \ \ \ \ \ \ \ \ uint16\_t\ dev,}
\DoxyCodeLine{00172\ \ \ \ \ \ \ \ \ uint16\_t\ \ \ \ \ \ index,}
\DoxyCodeLine{00173\ \ \ \ \ \ \ \ \ uint16\_t\ \ \ \ \ *pdata);}
\DoxyCodeLine{00177\ int8\_t\ \mbox{\hyperlink{vl53l1__platform_8h_add08bef8b78e81a212a80da93c3d0a05}{VL53L1\_RdDWord}}(}
\DoxyCodeLine{00178\ \ \ \ \ \ \ \ \ uint16\_t\ dev,}
\DoxyCodeLine{00179\ \ \ \ \ \ \ \ \ uint16\_t\ \ \ \ \ \ index,}
\DoxyCodeLine{00180\ \ \ \ \ \ \ \ \ uint32\_t\ \ \ \ \ *pdata);}
\DoxyCodeLine{00181\ }
\DoxyCodeLine{00185\ \textcolor{comment}{/*}}
\DoxyCodeLine{00186\ \textcolor{comment}{int8\_t\ VL53L1\_WaitMs(}}
\DoxyCodeLine{00187\ \textcolor{comment}{\ \ \ \ \ \ \ \ uint16\_t\ dev,}}
\DoxyCodeLine{00188\ \textcolor{comment}{\ \ \ \ \ \ \ \ int32\_t\ \ \ \ \ \ \ wait\_ms);}}
\DoxyCodeLine{00189\ \textcolor{comment}{*/}}
\DoxyCodeLine{00190\ }
\DoxyCodeLine{00191\ }
\DoxyCodeLine{00192\ }
\DoxyCodeLine{00193\ \textcolor{preprocessor}{\#endif}}

\end{DoxyCode}
